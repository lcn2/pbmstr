/*
 * pmbsir - form a pbm file using builtin fixed font from args
 *
 * usage:
 *	./pbmstr 'string 1' '2nd string' 'line3 string' 'the end' > foo.pbm
 *
 * Copyright (c) 2000-2001,2015,2023,2025 by Landon Curt Noll.  All Rights Reserved.
 *
 * Permission to use, copy, modify, and distribute this software and
 * its documentation for any purpose and without fee is hereby granted,
 * provided that the above copyright, this permission notice and text
 * this comment, and the disclaimer below appear in all of the following:
 *
 *       supporting documentation
 *       source copies
 *       source works derived from this source
 *       binaries derived from this source or from derived source
 *
 * LANDON CURT NOLL DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,
 * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO
 * EVENT SHALL LANDON CURT NOLL BE LIABLE FOR ANY SPECIAL, INDIRECT OR
 * CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF
 * USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 * OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 *
 * chongo (Landon Curt Noll) /\oo/\
 *
 * http://www.isthe.com/chongo/index.html
 * https://github.com/lcn2
 *
 * Share and enjoy!  :-)
 */

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/errno.h>


/*
 * official version
 */
#define VERSION "1.2.1 2025-03-26"          /* format: major.minor YYYY-MM-DD */


static const char * const usage =
  "usage: %s [-h] [-v level] [-V] [-n] string ...\n"
        "    [-c] [-o offset] arg ...\n"
        "\n"
        "    -h            print help message and exit\n"
        "    -v level      set verbosity level (def level: 0)\n"
        "    -V            print version string and exit\n"
        "\n"
	"    string ...	   string(s) as a line of text to convert to PBM image on stdout\n"
	"\n"
	"%s version: %s\n";


/*
 * builtin 8x13 fixed font - constructed by b64.chopup.sh
 *
 * font[c]     - array of GLYPH_PIXEL_ROWS octets for PBM font glyph
 * font[c][r]  - row r of char c of PBM font glyph
 */
#define ALPHABET_LEN 258	/* glyphs in alphabet */
#define GLYPH_PIXEL_ROWS 13	/* font is this many pixels high (8x13 font) */
#define GLYPH_PIXEL_COLS 8	/* font is this many pixels wide (8x13 font) */
static unsigned char font[ALPHABET_LEN][GLYPH_PIXEL_ROWS] = {
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 0 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 1 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 2 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 3 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 4 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 5 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 6 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 7 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 8 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 9 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 10 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 11 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 12 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 13 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 14 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 15 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 16 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 17 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 18 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 19 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 20 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 21 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 22 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 23 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 24 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 25 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 26 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 27 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 28 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 29 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 30 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 31 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 32 */
   {0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xff,0xf7,0xff,0xff,0xff,0xff}, /* 33 */
   {0xff,0xeb,0xeb,0xeb,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 34 */
   {0xff,0xf5,0xf5,0xc0,0xeb,0xeb,0x81,0xd7,0xd7,0xff,0xff,0xff,0xff}, /* 35 */
   {0xf7,0xe3,0xdd,0xdf,0xe7,0xf3,0xdd,0xdd,0xe3,0xf7,0xff,0xff,0xff}, /* 36 */
   {0xff,0xe7,0xdb,0xe6,0xf9,0xe7,0xd9,0xf6,0xf9,0xff,0xff,0xff,0xff}, /* 37 */
   {0xff,0xe3,0xdb,0xdf,0xee,0xc5,0xbb,0xb9,0xc6,0xff,0xff,0xff,0xff}, /* 38 */
   {0xff,0xf7,0xf7,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 39 */
   {0xfd,0xfb,0xfb,0xf7,0xf7,0xf7,0xf7,0xf7,0xfb,0xfb,0xfd,0xff,0xff}, /* 40 */
   {0xdf,0xef,0xef,0xf7,0xf7,0xf7,0xf7,0xf7,0xef,0xef,0xdf,0xff,0xff}, /* 41 */
   {0xff,0xf7,0xf7,0xc1,0xf7,0xeb,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 42 */
   {0xff,0xff,0xff,0xf7,0xf7,0xc1,0xf7,0xf7,0xff,0xff,0xff,0xff,0xff}, /* 43 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xef,0xdf,0xff,0xff,0xff}, /* 44 */
   {0xff,0xff,0xff,0xff,0xff,0xc1,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 45 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xff,0xff,0xff,0xff}, /* 46 */
   {0xfe,0xfd,0xfd,0xfb,0xfb,0xf7,0xf7,0xef,0xef,0xdf,0xff,0xff,0xff}, /* 47 */
   {0xe3,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 48 */
   {0xf7,0xc7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xc1,0xff,0xff,0xff,0xff}, /* 49 */
   {0xe3,0xdd,0xdd,0xdd,0xfb,0xf7,0xef,0xdd,0xc1,0xff,0xff,0xff,0xff}, /* 50 */
   {0xe3,0xdd,0xfd,0xfd,0xf3,0xfd,0xfd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 51 */
   {0xfb,0xf3,0xeb,0xeb,0xdb,0xbb,0x81,0xfb,0xf1,0xff,0xff,0xff,0xff}, /* 52 */
   {0xc1,0xdf,0xdf,0xdf,0xc3,0xfd,0xfd,0xbd,0xc3,0xff,0xff,0xff,0xff}, /* 53 */
   {0xf1,0xef,0xdf,0xdf,0xc3,0xdd,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 54 */
   {0xc1,0xdd,0xfb,0xfb,0xfb,0xfb,0xf7,0xf7,0xf7,0xff,0xff,0xff,0xff}, /* 55 */
   {0xe3,0xdd,0xdd,0xdd,0xe3,0xdd,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 56 */
   {0xe3,0xdd,0xdd,0xdd,0xdd,0xe1,0xfd,0xfb,0xc7,0xff,0xff,0xff,0xff}, /* 57 */
   {0xff,0xff,0xff,0xff,0xf7,0xff,0xff,0xff,0xf7,0xff,0xff,0xff,0xff}, /* 58 */
   {0xff,0xff,0xff,0xff,0xf7,0xff,0xff,0xf7,0xf7,0xef,0xff,0xff,0xff}, /* 59 */
   {0xff,0xff,0xfb,0xf7,0xef,0xdf,0xef,0xf7,0xfb,0xff,0xff,0xff,0xff}, /* 60 */
   {0xff,0xff,0xff,0xff,0xc1,0xff,0xc1,0xff,0xff,0xff,0xff,0xff,0xff}, /* 61 */
   {0xff,0xff,0xef,0xf7,0xfb,0xfd,0xfb,0xf7,0xef,0xff,0xff,0xff,0xff}, /* 62 */
   {0xff,0xe3,0xdd,0xfd,0xfb,0xf7,0xf7,0xff,0xf7,0xff,0xff,0xff,0xff}, /* 63 */
   {0xff,0xe3,0xdd,0xd9,0xd5,0xd5,0xd8,0xdf,0xe3,0xff,0xff,0xff,0xff}, /* 64 */
   {0xff,0xc7,0xf7,0xeb,0xeb,0xc1,0xdd,0xdd,0x88,0xff,0xff,0xff,0xff}, /* 65 */
   {0xff,0x83,0xdd,0xdd,0xc3,0xdd,0xdd,0xdd,0x83,0xff,0xff,0xff,0xff}, /* 66 */
   {0xff,0xe3,0xdd,0xdd,0xdf,0xdf,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 67 */
   {0xff,0x83,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0x83,0xff,0xff,0xff,0xff}, /* 68 */
   {0xff,0x81,0xdd,0xd7,0xc7,0xd7,0xdf,0xdd,0x81,0xff,0xff,0xff,0xff}, /* 69 */
   {0xff,0x81,0xdd,0xd5,0xc7,0xd7,0xdf,0xdf,0x87,0xff,0xff,0xff,0xff}, /* 70 */
   {0xff,0xe3,0xdd,0xdd,0xdf,0xd9,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 71 */
   {0xff,0x88,0xdd,0xdd,0xc1,0xdd,0xdd,0xdd,0x88,0xff,0xff,0xff,0xff}, /* 72 */
   {0xff,0xe1,0xfb,0xfb,0xfb,0xfb,0xdb,0xdb,0xe7,0xff,0xff,0xff,0xff}, /* 73 */
   {0xff,0xc1,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xc1,0xff,0xff,0xff,0xff}, /* 74 */
   {0xff,0x89,0xdb,0xd7,0xcf,0xc7,0xdb,0xdd,0x8c,0xff,0xff,0xff,0xff}, /* 75 */
   {0xff,0x8f,0xdf,0xdf,0xdf,0xdf,0xdd,0xdd,0x81,0xff,0xff,0xff,0xff}, /* 76 */
   {0xff,0x9c,0xc9,0xc9,0xd5,0xd5,0xd5,0xdd,0x88,0xff,0xff,0xff,0xff}, /* 77 */
   {0xff,0x98,0xcd,0xcd,0xd5,0xd5,0xd9,0xd9,0x8d,0xff,0xff,0xff,0xff}, /* 78 */
   {0xff,0xe3,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 79 */
   {0xff,0x83,0xd9,0xdd,0xd9,0xc3,0xdf,0xdf,0x87,0xff,0xff,0xff,0xff}, /* 80 */
   {0xff,0xe3,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xe3,0xf9,0xff,0xff,0xff}, /* 81 */
   {0xff,0x83,0xdd,0xdd,0xc3,0xdb,0xdd,0xdd,0x8c,0xff,0xff,0xff,0xff}, /* 82 */
   {0xff,0xe1,0xdd,0xdf,0xc7,0xf1,0xfd,0xdd,0xc3,0xff,0xff,0xff,0xff}, /* 83 */
   {0xff,0x80,0xb6,0xb6,0xf7,0xf7,0xf7,0xf7,0xc1,0xff,0xff,0xff,0xff}, /* 84 */
   {0xff,0x88,0xdd,0xdd,0xdd,0xdd,0xdd,0xc9,0xe3,0xff,0xff,0xff,0xff}, /* 85 */
   {0xff,0x88,0xdd,0xdd,0xc9,0xeb,0xeb,0xe3,0xf7,0xff,0xff,0xff,0xff}, /* 86 */
   {0xff,0x88,0xdd,0xd5,0xd5,0xd5,0xc9,0xeb,0xeb,0xff,0xff,0xff,0xff}, /* 87 */
   {0xff,0x88,0xdd,0xeb,0xf7,0xeb,0xeb,0xdd,0x88,0xff,0xff,0xff,0xff}, /* 88 */
   {0xff,0x88,0xdd,0xeb,0xeb,0xf7,0xf7,0xf7,0xe3,0xff,0xff,0xff,0xff}, /* 89 */
   {0xff,0xc1,0xdd,0xdb,0xf7,0xf7,0xed,0xdd,0xc1,0xff,0xff,0xff,0xff}, /* 90 */
   {0xf3,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf3,0xff,0xff}, /* 91 */
   {0xdf,0xef,0xef,0xf7,0xf7,0xfb,0xfb,0xfd,0xfd,0xfe,0xff,0xff,0xff}, /* 92 */
   {0xe7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xe7,0xff,0xff}, /* 93 */
   {0xff,0xf7,0xeb,0xdd,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 94 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x80,0xff}, /* 95 */
   {0xff,0xf7,0xf7,0xfb,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 96 */
   {0xff,0xff,0xff,0xc3,0xfd,0xe1,0xdd,0xdd,0xe2,0xff,0xff,0xff,0xff}, /* 97 */
   {0x9f,0xdf,0xdf,0xc3,0xdd,0xdd,0xdd,0xdd,0xa3,0xff,0xff,0xff,0xff}, /* 98 */
   {0xff,0xff,0xff,0xe3,0xdd,0xdf,0xdf,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 99 */
   {0xf9,0xfd,0xfd,0xe1,0xdd,0xdd,0xdd,0xdd,0xe2,0xff,0xff,0xff,0xff}, /* 100 */
   {0xff,0xff,0xff,0xe3,0xdd,0xc1,0xdf,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 101 */
   {0xf1,0xef,0xef,0xc1,0xef,0xef,0xef,0xef,0xc3,0xff,0xff,0xff,0xff}, /* 102 */
   {0xff,0xff,0xff,0xe2,0xdd,0xdd,0xdd,0xdd,0xe1,0xfd,0xfd,0xe3,0xff}, /* 103 */
   {0x9f,0xdf,0xdf,0xd3,0xcd,0xdd,0xdd,0xdd,0x88,0xff,0xff,0xff,0xff}, /* 104 */
   {0xf7,0xff,0xff,0xc7,0xf7,0xf7,0xf7,0xf7,0xc1,0xff,0xff,0xff,0xff}, /* 105 */
   {0xfb,0xff,0xff,0xc3,0xfb,0xfb,0xfb,0xfb,0xfb,0xfb,0xfb,0xc7,0xff}, /* 106 */
   {0x9f,0xdf,0xdf,0xd9,0xd7,0xcf,0xd7,0xdb,0x9c,0xff,0xff,0xff,0xff}, /* 107 */
   {0xc7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xc0,0xff,0xff,0xff,0xff}, /* 108 */
   {0xff,0xff,0xff,0x8b,0xd5,0xd5,0xd5,0xd5,0x94,0xff,0xff,0xff,0xff}, /* 109 */
   {0xff,0xff,0xff,0xa3,0xcd,0xdd,0xdd,0xdd,0x8c,0xff,0xff,0xff,0xff}, /* 110 */
   {0xff,0xff,0xff,0xe3,0xdd,0xdd,0xdd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 111 */
   {0xff,0xff,0xff,0xa3,0xdd,0xdd,0xdd,0xdd,0xc3,0xdf,0xdf,0x8f,0xff}, /* 112 */
   {0xff,0xff,0xff,0xe2,0xdd,0xdd,0xdd,0xdd,0xe1,0xfd,0xfd,0xf8,0xff}, /* 113 */
   {0xff,0xff,0xff,0xd1,0xef,0xef,0xef,0xef,0xc3,0xff,0xff,0xff,0xff}, /* 114 */
   {0xff,0xff,0xff,0xe3,0xdd,0xe3,0xfd,0xdd,0xe3,0xff,0xff,0xff,0xff}, /* 115 */
   {0xff,0xef,0xef,0xc1,0xef,0xef,0xef,0xee,0xf1,0xff,0xff,0xff,0xff}, /* 116 */
   {0xff,0xff,0xff,0x99,0xdd,0xdd,0xdd,0xdd,0xe2,0xff,0xff,0xff,0xff}, /* 117 */
   {0xff,0xff,0xff,0x88,0xdd,0xdd,0xeb,0xe3,0xf7,0xff,0xff,0xff,0xff}, /* 118 */
   {0xff,0xff,0xff,0x88,0xdd,0xd5,0xd5,0xeb,0xeb,0xff,0xff,0xff,0xff}, /* 119 */
   {0xff,0xff,0xff,0x88,0xeb,0xf7,0xeb,0xdd,0x9c,0xff,0xff,0xff,0xff}, /* 120 */
   {0xff,0xff,0xff,0x88,0xdd,0xdd,0xeb,0xe3,0xf7,0xf7,0xf7,0xcf,0xff}, /* 121 */
   {0xff,0xff,0xff,0xc1,0xdb,0xf7,0xef,0xdd,0xc1,0xff,0xff,0xff,0xff}, /* 122 */
   {0xff,0xfb,0xf7,0xf7,0xf7,0xef,0xf7,0xf7,0xf7,0xf7,0xfb,0xff,0xff}, /* 123 */
   {0xff,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xf7,0xff,0xff}, /* 124 */
   {0xff,0xef,0xf7,0xf7,0xf7,0xfb,0xf7,0xf7,0xf7,0xf7,0xef,0xff,0xff}, /* 125 */
   {0xff,0xff,0xff,0xff,0xed,0xd5,0xdb,0xff,0xff,0xff,0xff,0xff,0xff}, /* 126 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 127 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 128 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 129 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 130 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 131 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 132 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 133 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 134 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 135 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 136 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 137 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 138 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 139 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 140 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 141 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 142 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 143 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 144 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 145 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 146 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 147 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 148 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 149 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 150 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 151 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 152 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 153 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 154 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 155 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 156 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 157 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 158 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 159 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 160 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 161 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 162 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 163 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 164 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 165 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 166 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 167 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 168 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 169 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 170 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 171 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 172 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 173 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 174 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 175 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 176 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 177 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 178 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 179 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 180 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 181 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 182 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 183 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 184 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 185 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 186 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 187 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 188 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 189 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 190 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 191 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 192 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 193 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 194 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 195 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 196 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 197 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 198 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 199 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 200 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 201 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 202 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 203 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 204 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 205 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 206 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 207 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 208 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 209 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 210 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 211 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 212 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 213 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 214 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 215 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 216 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 217 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 218 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 219 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 220 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 221 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 222 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 223 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 224 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 225 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 226 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 227 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 228 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 229 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 230 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 231 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 232 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 233 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 234 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 235 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 236 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 237 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 238 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 239 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 240 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 241 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 242 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 243 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 244 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 245 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 246 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 247 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 248 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 249 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 250 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 251 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 252 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 253 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}, /* 254 */
   {0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}  /* 255 */
};


/*
 * static declarations
 */
static char *program = NULL;	/* our name */
static char *prog = NULL;       /* basename of program */
static const char * const version = VERSION;
static long verbosity = 0;      /* verbosity level */
static char *pbmtext(char **str, int str_cnt, int *pbm_len);
/**/
static void pr_usage(FILE *stream);

int
main(int argc, char *argv[])
{
    int pbm_len;		/* image size in octets */
    char *pbm;			/* formed image */
    char *p;
    int i;

    /*
     * arg check
     */
    program = argv[0];
    while ((i = getopt(argc, argv, ":hv:Vnco:")) != -1) {
        switch (i) {

        case 'h':                   /* -h - print help message and exit */
            pr_usage(stderr);
            exit(2); /* ooo */
            /*NOTREACHED*/

        case 'v':                   /* v level - set verbosity level */
            errno = 0;
            verbosity = strtol(optarg, NULL, 0);
            if (errno != 0 || verbosity < 0) {
                verbosity = 0;
            }
            break;

        case 'V':                   /* -V - print version string and exit */
            (void) printf("%s\n", version);
            exit(2); /* ooo */
            /*NOTREACHED*/

	case ':':
            (void) fprintf(stderr, "%s: ERROR: requires an argument -- %c\n", program, optopt);
            pr_usage(stderr);
            exit(3); /* ooo */
            /*NOTREACHED*/

        case '?':
            (void) fprintf(stderr, "%s: ERROR: illegal option -- %c\n", program, optopt);
            pr_usage(stderr);
            exit(3); /* ooo */
            /*NOTREACHED*/

        default:
            fprintf(stderr, "%s: ERROR: invalid -flag\n", program);
            exit(3); /* ooo */
            /*NOTREACHED*/
        }
    }
    /* skip over command line options */
    argv += optind;
    argc -= optind;
    /* check the arg count */
    if (argc < 1) {
        fprintf(stderr, "%s: ERROR: expected at least 1 arg, found: %d\n", program, argc);
        pr_usage(stderr);
        exit(3); /* ooo */
        /*NOTREACHED*/
    }

    /*
     * create the pbm
     */
    pbm = pbmtext(argv+1, argc-1, &pbm_len);
    if (pbm == NULL) {
	fprintf(stderr, "%s: unable to form image\n", program);
	exit(3);
    }

    /*
     * write the PBM image
     */
    fwrite(pbm, pbm_len, 1, stdout);
    exit(0);
}


/*
 * pr_usage - print usage message
 *
 * given:
 *
 *    stream - print usage message on stream, NULL ==> stderr
 */
static void
pr_usage(FILE *stream)
{
    /*
     * NULL stream means stderr
     */
    if (stream == NULL) {
        stream = stderr;
    }

    /*
     * firewall - change program if NULL
     */
    if (program == NULL) {
        program = "((NULL))";
    }

    /*
     * firewall set name if NULL
     */
    if (prog == NULL) {
        prog = rindex(program, '/');
    }
    /* paranoia if no / is found */
    if (prog == NULL) {
        prog = program;
    } else {
        ++prog;
    }

    /*
     * print usage message to stderr
     */
    fprintf(stream, usage, program, prog, version);
}


/*
 * pbmtext - allocate and load a pbm in memory
 *
 * given:
 *	char **str		array of pointers to string to load
 *	int str_cnt		number of strings in str
 *	int *pbm_len		point to where pbm image length is placed
 *
 * sets:
 *	*pbm_len	value is set to the full PBM image size in octets
 *
 * returns
 *	char *		pbm image (*pbm_len set ti size in octets) or NULL
 *
 * This function return NULL if passed a bad arg (str == NULL or str_cnt <= 0
 * or pbm_len == NULL); all strings in the string list are empty; the image
 * image is too large (> 2^31 octets).
 */
static char *
pbmtext(char **str, int str_cnt, int *pbm_len)
{
    int glyph_rows;	/* image rows in font chars */
    int glyph_cols;	/* image columns in font chars, longest arg in chars */
    unsigned char pbm_header[1+1+1+10+1+10+1+1];  /* tmp PMB header, max size */
    int pbm_header_len;				  /* actual PBM header length */
    char *pbm;		/* complete pmg image */
    char *row_p;	/* start of glyph row */
    int row;		/* current glyph row number */
    int pbm_size;	/* size in octets of the image after the header */
    char *p;
    char *q;
    int i;
    int j;

    /*
     * firewall
     */
    if (str == NULL || str_cnt <= 0 || pbm_len == NULL || str_cnt <= 0) {
	/* bogus arg */
	return NULL;
    }

    /*
     * determine the longest arg
     *
     * The longest string determines how wide (in terms of glyphs) the image
     * will be.  The number of strings determine how tall (in terms of glyphs)
     * the image will be.
     */
    glyph_cols = 0;
    for (i=0; i < str_cnt; ++i) {
	if (strlen(str[i]) > glyph_cols) {
	    glyph_cols = strlen(str[i]);
	}
    }
    if (glyph_cols <= 0) {
	/* all strings are empty */
	return NULL;
    }
    glyph_rows = str_cnt;

    /*
     * Catch the case where we would create an image that would exceed the
     * pbm_header size (10 digit pixel width or height) or that would create
     * an image > 2^31-1 octets in size.  We account the extra guard
     * octet as well.
     */
    if ((long long)glyph_cols*GLYPH_PIXEL_COLS > 9999999999LL ||
	(long long)glyph_rows*GLYPH_PIXEL_ROWS > 9999999999LL ||
        ((long long)glyph_cols * (long long)GLYPH_PIXEL_COLS *
	 (long long)glyph_rows * (long long)GLYPH_PIXEL_ROWS) >
	(0x7fffffffLL-((long long)sizeof(pbm_header)))-1) {
	/* size too large */
	return NULL;
    }

    /*
     * determine what the final PBM header will look like
     */
    pbm_size = glyph_rows * GLYPH_PIXEL_ROWS * glyph_cols;
    sprintf((char *)pbm_header, "P4\n%d %d\n",
	    glyph_cols * GLYPH_PIXEL_COLS,
	    glyph_rows * GLYPH_PIXEL_ROWS);
    pbm_header_len = strlen(pbm_header);

    /*
     * allocate PBM image storage
     */
    pbm = (unsigned char *)malloc(pbm_header_len + pbm_size + 1);
    if (pbm == NULL) {
	/* malloc failure */
	return NULL;
    }

    /*
     * Initialize the PBM image
     *
     * We will set the image to black pixels and load PMB header.
     */
    strcpy(pbm, pbm_header);
    memset(pbm+pbm_header_len, 0xff, pbm_size);

    /*
     * fill in the image, one glyph row at a time
     */
    for (row_p = pbm + pbm_header_len, row=0;
	 row < glyph_rows;
	 ++row, row_p += (GLYPH_PIXEL_ROWS * glyph_cols)) {

	int col;		/* current glyph column number */

	/*
	 * fill in the glyph image row, one column at a tme
	 */
	for (p = str[row], col = 0; col < glyph_cols; ++col) {

	    unsigned char *glyph;	/* current glyph to load */
	    unsigned char *col_p;	/* start of glyph col in row_p */
	    int gpix_row;		/* current pixel row in glyph */

	    /*
	     * determine which glyph we will form
	     */
	    if (*p == '\0') {
		/* no glpyh, leave as default space, end of row */
		break;
	    } else {
		glyph = font[(int)*p++];
	    }

	    /*
	     * load the glpyh, one pixel row at a time
	     */
	    for (col_p = row_p+col, gpix_row = 0;
		 gpix_row < GLYPH_PIXEL_ROWS;
		 ++gpix_row, col_p += glyph_cols) {
		*col_p = glyph[gpix_row];
	    }
	}
    }

    /*
     * deposit the real image size in octets
     */
    *pbm_len = pbm_header_len + pbm_size;

    /*
     * return the PBM
     */
    return pbm;
}
